<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <style type="text/css">
    html { height: 100% }
    body { height: 100%; margin: 0; padding: 0 }
    #map-canvas { height: 100% }
  </style>

</head>

<body>
  <%= form_tag bike_stations_index_path, :id => "find_stations" do %>
    <%= hidden_field_tag 'origin', @origin.address, :id => "origin" %>
    <%= hidden_field_tag 'route', @bike_stations.first.id, :id => "route" %>
    <div>
      <input id="new_origin"></input>
      <span>San Francisco, CA</span>
      <br/>
      <%= submit_tag 'Set Location', :id => "set_origin" %>
    </div>

  <div>
    <ol>
      <% @bike_stations.each_with_index do |station| %>
        <li>
          <%= "#{station.distance.round(2)} miles - #{station.name} (#{station.spaces} Spaces)" %>
          <%= submit_tag 'Route', :class => "new_route", :id => station.id %>
        </li>
      <% end %>
    </ol>
  </div>
  <% end %>

  <div id="map-canvas"></div>
</body>

<%= render 'map_js' %>

<script type="text/javascript">
  $(".new_route").click(function(e){
    e.preventDefault();
    console.log($('#new_origin').val());
    $("#route").val($(this).attr("id"));
    $('#find_stations').submit();
  });

  $("#set_origin").click(function(e){
    e.preventDefault();
    $("#route").val("");
    $("#origin").val($("#new_origin").val());
    $('#find_stations').submit();
  });
</script>


